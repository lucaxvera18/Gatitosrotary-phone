<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Para la más linda ❤️</title>
<style>
  html,body {margin:0;height:100%;background:#000;overflow:hidden;}
  canvas {display:block;width:100vw;height:100vh;image-rendering:pixelated;}
  /* Opcional: Para cargar la fuente de estilo retro */
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let W, H;

function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
window.onresize = resize;
resize();

// Estrellas
const stars = [...Array(200)].map(() => ({
  x: Math.random() * W,
  y: Math.random() * H,
  s: Math.random() < 0.7 ? 1 : 2
}));

// Corazones (no se están usando en el código, pero los he dejado por si quieres reincorporarlos)
function drawHeart(x, y, s, color) {
  ctx.fillStyle = color;
  ctx.beginPath();
  ctx.moveTo(x, y);
  ctx.bezierCurveTo(x - s, y - s, x - 2 * s, y + 0.5 * s, x, y + 2 * s);
  ctx.bezierCurveTo(x + 2 * s, y + 0.5 * s, x + s, y - s, x, y);
  ctx.fill();
}

// Gatitos (subidos un poco)
function drawCat(x, y, flip = false) {
  ctx.save();
  ctx.translate(x, y);
  if (flip) ctx.scale(-1, 1);
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(0, 0, 30, 0, Math.PI * 2);
  ctx.fill(); // cabeza
  ctx.fillRect(-20, 25, 40, 20); // cuerpo
  ctx.fillStyle = "pink";
  ctx.beginPath();
  ctx.arc(-15, -15, 10, 0, Math.PI * 2);
  ctx.fill(); // oreja izquierda
  ctx.beginPath();
  ctx.arc(15, -15, 10, 0, Math.PI * 2);
  ctx.fill(); // oreja derecha
  ctx.restore();
}

// Fuegos artificiales
let firework;
const message = "Para la más linda ❤️";
const colors = ["#ff2d2d", "#ff7f00", "#ffff3d", "#3dff4a", "#2dbbff", "#ff2dfd"];

function createFirework() {
  firework = {
    x: W / 2,
    y: H,
    vy: -6,
    explode: false,
    particles: [],
    sparks: [],
    done: false
  };
}

function createTextParticles() {
  const off = document.createElement("canvas");
  const octx = off.getContext("2d");
  off.width = W;
  off.height = H / 2;
  octx.fillStyle = "white";
  octx.font = `bold ${Math.floor(H / 10)}px "Press Start 2P", "Courier New", monospace`;
  octx.textAlign = "center";
  octx.textBaseline = "middle";
  octx.fillText(message, off.width / 2, off.height / 2);

  const d = octx.getImageData(0, 0, off.width, off.height).data;
  const pts = [];
  // Se ha aumentado la densidad para un texto más detallado
  for (let y = 0; y < off.height; y += 4) {
    for (let x = 0; x < off.width; x += 4) {
      if (d[(y * off.width + x) * 4 + 3] > 128) {
        pts.push({ x, y });
      }
    }
  }

  // Se inicializa cada partícula de texto con una velocidad aleatoria
  firework.particles = pts.map(p => ({
    x: firework.x,
    y: firework.y,
    tx: p.x,
    ty: p.y,
    vx: (Math.random() - 0.5) * 8, // Velocidad inicial más alta para el efecto de explosión
    vy: (Math.random() - 0.5) * 8,
    life: 0
  }));

  // Chispas de colores
  firework.sparks = [...Array(100)].map(() => ({
    x: firework.x,
    y: firework.y,
    vx: (Math.random() - 0.5) * 10, // Aumento de velocidad inicial para las chispas
    vy: (Math.random() - 0.5) * 10,
    color: colors[Math.floor(Math.random() * colors.length)],
    life: 60 + Math.random() * 40
  }));
}

// Animación
function loop() {
  ctx.fillStyle = "rgba(5, 0, 23, 0.1)"; // Fondo con transparencia para un rastro de las estrellas y chispas
  ctx.fillRect(0, 0, W, H);

  // Estrellas
  ctx.fillStyle = "white";
  for (const s of stars) ctx.fillRect(s.x, s.y, s.s, s.s);

  // Gatos
  drawCat(80, H - 140, false);
  drawCat(W - 80, H - 140, true);

  // Fuegos artificiales
  if (firework) {
    if (!firework.explode) {
      // El cohete que sube
      ctx.fillStyle = "pink"; // Color del cohete, cambiado a rosa
      ctx.fillRect(firework.x - 2, firework.y - 10, 4, 10);
      firework.y += firework.vy;
      // Condición de explosión basada en un punto relativo a la altura
      if (firework.y < H / 2) {
        firework.explode = true;
        createTextParticles();
      }
    } else {
      // Partículas del texto
      for (const p of firework.particles) {
        p.life++;
        // Corrección: el texto se mueve hacia su posición objetivo
        p.vx += (p.tx - p.x) * 0.005;
        p.vy += (p.ty - p.y) * 0.005;

        p.vx *= 0.95; // Fricción para un movimiento más suave
        p.vy *= 0.95;

        p.x += p.vx;
        p.y += p.vy;

        ctx.fillStyle = "pink";
        // Tamaño de las partículas
        const size = Math.max(0, 4 - p.life * 0.05);
        ctx.fillRect(p.x, p.y, size, size);
      }
      // Chispas
      for (const s of firework.sparks) {
        if (s.life > 0) {
          s.life--;
          s.x += s.vx;
          s.y += s.vy;
          s.vy += 0.05; // Gravedad para las chispas
          ctx.fillStyle = s.color;
          // Reducción del tamaño de la chispa con el tiempo
          const sparkSize = Math.max(0, s.life * 0.05);
          ctx.fillRect(s.x, s.y, sparkSize, sparkSize);
        }
      }
    }
  }

  requestAnimationFrame(loop);
}

// Inicia el primer fuego artificial y lo repite cada 10 segundos
createFirework();
loop();
setInterval(createFirework, 10000);
</script>
</body>
</html>
